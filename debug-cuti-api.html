<!DOCTYPE html>
<html>
<head>
    <title>Debug Cuti API</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 800px; margin: 0 auto; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; margin-bottom: 5px; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; cursor: pointer; }
        .result { margin-top: 20px; padding: 10px; background: #f8f9fa; border: 1px solid #ddd; }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Debug Cuti API</h1>
        
        <div class="form-group">
            <h3>1. Check Pegawai ID 16</h3>
            <button onclick="checkPegawai()">Check Pegawai 16</button>
            <div id="pegawaiResult" class="result" style="display:none;"></div>
        </div>

        <div class="form-group">
            <h3>2. Check Jenis Cuti ID 3</h3>
            <button onclick="checkJenisCuti()">Check Jenis Cuti 3</button>
            <div id="jenisCutiResult" class="result" style="display:none;"></div>
        </div>

        <div class="form-group">
            <h3>3. Simple Cuti Test</h3>
            <button onclick="testCutiSimple()">Test Simple Cuti</button>
            <div id="cutiTestResult" class="result" style="display:none;"></div>
        </div>

        <div class="form-group">
            <h3>4. Full Cuti Test</h3>
            <button onclick="testCutiFull()">Test Full Cuti</button>
            <div id="cutiFullResult" class="result" style="display:none;"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8080';

        async function checkPegawai() {
            try {
                const response = await fetch(`${API_BASE}/api/pegawai/16`);
                const data = await response.json();
                
                const resultDiv = document.getElementById('pegawaiResult');
                resultDiv.style.display = 'block';
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `<h4>Pegawai Found!</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `<h4>Error!</h4><p>${data.message || 'Unknown error'}</p>`;
                }
            } catch (error) {
                const resultDiv = document.getElementById('pegawaiResult');
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<h4>Error!</h4><p>${error.message}</p>`;
            }
        }

        async function checkJenisCuti() {
            try {
                const response = await fetch(`${API_BASE}/api/jenis-cuti/3`);
                const data = await response.json();
                
                const resultDiv = document.getElementById('jenisCutiResult');
                resultDiv.style.display = 'block';
                
                if (response.ok) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `<h4>Jenis Cuti Found!</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `<h4>Error!</h4><p>${data.message || 'Unknown error'}</p>`;
                }
            } catch (error) {
                const resultDiv = document.getElementById('jenisCutiResult');
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<h4>Error!</h4><p>${error.message}</p>`;
            }
        }

        async function testCutiSimple() {
            try {
                // Test with simple data first
                const formData = new FormData();
                formData.append('pegawaiId', '1'); // Use ID 1 first
                formData.append('tanggalDari', '2025-07-29');
                formData.append('tanggalKe', '2025-07-29');
                formData.append('jenisCuti', '1'); // Use ID 1 first
                formData.append('alasanCuti', 'Test cuti sederhana');

                const response = await fetch(`${API_BASE}/api/cuti/ajukan`, {
                    method: 'POST',
                    body: formData
                });

                const resultDiv = document.getElementById('cutiTestResult');
                resultDiv.style.display = 'block';

                if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `<h4>Success!</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `<h4>Error!</h4><p>${errorText}</p>`;
                }
            } catch (error) {
                const resultDiv = document.getElementById('cutiTestResult');
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<h4>Error!</h4><p>${error.message}</p>`;
            }
        }

        async function testCutiFull() {
            try {
                // Test with original failing data
                const formData = new FormData();
                formData.append('pegawaiId', '16');
                formData.append('tanggalDari', '2025-07-28');
                formData.append('tanggalKe', '2025-07-31');
                formData.append('jenisCuti', '3');
                formData.append('alasanCuti', 'MALAS KERJA');

                const response = await fetch(`${API_BASE}/api/cuti/ajukan`, {
                    method: 'POST',
                    body: formData
                });

                const resultDiv = document.getElementById('cutiFullResult');
                resultDiv.style.display = 'block';

                if (response.ok) {
                    const data = await response.json();
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `<h4>Success!</h4><pre>${JSON.stringify(data, null, 2)}</pre>`;
                } else {
                    const errorText = await response.text();
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `<h4>Error!</h4><p>${errorText}</p>`;
                }
            } catch (error) {
                const resultDiv = document.getElementById('cutiFullResult');
                resultDiv.style.display = 'block';
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `<h4>Error!</h4><p>${error.message}</p>`;
            }
        }
    </script>
</body>
</html>
